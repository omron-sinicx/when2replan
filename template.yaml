organization: OMRON SINIC X
twitter: '@omron_sinicx'
title: 'When to Replan? An Adaptive Replanning Strategy for Autonomous Navigation using Deep Reinforcement Learning'
conference: ICRA2024
resources:
  paper: https://arxiv.org/abs/2304.12046
  code: https://github.com/omron-sinicx/whn2replan # FIXME
  video: https://www.youtube.com/embed/W8nBFKDxsb0
  blog: # TODO
description: evaluated different replanning strategies and propose an adaptive replanning strategy using deep reinforcement learning
image: https://omron-sinicx.github.io/whn2replan/assets/overview.png
url:
  https://omron-sinicx.github.io/whn2replan
  # speakerdeck: b7a0614c24014dcbbb121fbb9ed234cd
authors:
  - name: Kohei Honda*
    affiliation: [1, 2]
    url: http://kohonda.github.io
    position: intern
  - name: Ryo Yonetani
    affiliation: [1]
    position: research scientist
    url: https://yonetaniryo.github.io/
  - name: Mai Nishimura
    affiliation: [1]
    position: senior researcher
    url: https://denkiwakame.github.io
  - name: Tadashi Kozuno
    affiliation: [1]
    url: https://tadashik.github.io
contact_ids: ['omron', 3] #=> github issues, contact@sinicx.com, 2nd author
affiliations:
  - OMRON SINIC X Corporation
  - Nagoya University
meta:
  - '* work done as an intern at OMRON SINIC X.'
bibtex: >
  @misc{honda2024replan,
        title={When to Replan? An Adaptive Replanning Strategy for Autonomous Navigation using Deep Reinforcement Learning},
        author={Kohei Honda and Ryo Yonetani and Mai Nishimura and Tadashi Kozuno},
        year={2024},
        eprint={2304.12046},
        archivePrefix={arXiv},
        primaryClass={cs.RO}
  }

overview: |
  The hierarchy of global and local planners is one of the most commonly utilized system designs in autonomous robot navigation. While the global planner generates a reference path from the current to goal locations based on the pre-built map, the local planner produces a kinodynamic trajectory to follow the reference path while avoiding perceived obstacles. To account for unforeseen or dynamic obstacles not present on the pre-built map, **``when to replan''** the reference path is critical for the success of safe and efficient navigation. However, determining the ideal timing to execute replanning in such partially unknown environments still remains an open question. In this work, we first conduct an extensive simulation experiment to compare several common replanning strategies and confirm that effective strategies are highly dependent on the environment as well as the global and local planners. Based on this insight, we then derive a new adaptive replanning strategy based on deep reinforcement learning, which can learn from experience to decide appropriate replanning timings in the given environment and planning setups. Our experimental results show that the proposed replanner can perform on par or even better than the current best-performing strategies in multiple situations regarding navigation robustness and efficiency.

method:
  - title: Adaptive Replanning using Deep Reinforcement Learning
    image: overview.png
    text: >
      We derive a replanning controller that can learn from its previous navigation experiences to create a better replanning
      timing for navigation efficiency and robustness. As illustrated in the following figure,
      the replanner’s action is essentially the same as that of existing replanning strategies, i.e., binary actions indicating whether or not to execute replanning to produce
      a new reference path for the local planner after the current
      time step $k$. In other words, the replanner can potentially be
      utilized as a replacement module for the replanning strategy
      in existing planning frameworks, thus making it compatible
      with various combinations of planners and other modules.

results:
  - text: |
      ### v.s. Conventional Replanning Strategies
      <div uk-grid>
        <div class="uk-width-1-3 uk-text-center">
          <span class="uk-label uk-label-default">Distance-based</span>
          <video
            src="assets/distancebased.mp4"
            uk-video
            loop
            muted
          />
        </div>
        <div class="uk-width-1-3 uk-text-center">
          <span class="uk-label uk-label-default">Stuck-based</span>
          <video
            src="assets/stuckbased.mp4"
            uk-video
            loop
            muted
          />
        </div>
        <div class="uk-width-1-3 uk-text-center">
          <span class="uk-label uk-label-default">Time-based</span>
          <video
            src="assets/timebased.mp4"
            width="250px"
            uk-video="autoplay:inview"
            loop
            muted
          />
        </div>
      </div>
  - text: |
      We conduct a comprehensive simulation study to systematically evaluate the existing planning strategies and the DRL replanner.
      In this work, we compare four types of rule-based replanning available in ROS2 Navigation Stack.
      - Distance-based: determines replanning timings on the basis of traveled distance.
      - Stuck-based: decides to execute replans when the robot stops at the same position for a given $\Delta t_{\text{stuck}}$ seconds.
      - Time-based: performs replanning at every fixed period of $\Delta t_{\text{rep}}$ seconds.
      - Time w/patience: adopts *time-based* strategy when the robot is far rom the goal and changes to *stuck-based* otherwise, expecting to prevent a large detour near the goal.
  - text: |
      <h3>Selected Simulation Results</h3>
      <div uk-grid>
        <div class="uk-overflow-auto">
          <table class="uk-table uk-table-small uk-text-small uk-table-divider">
            <thead>
              <tr>
                <th>No ENTRY AREAS</th>
                <th colspan="5" class="uk-text-center">16</th>
              </tr>
              <tr>
                <th>Metric</th>
                <th>SR ⬆️</th>
                <th>CR ⬇️</th>
                <th>SGT ⬆️</th>
                <th>SPL ⬆️</th>
                <th>NR ⬇️</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  No replan
                </td>
                <td>27</td>
                <td>10</td>
                <td>0.439</td>
                <td>0.270</td>
                <td>--</td>
              </tr>
              <tr>
                <td>
                  Distance-based<br/> Stuck-based <br/> Time-based <br/> Time w/ patience
                </td>
                <td>
                  62<br/>64<br/>70<br/>70
                </td>
                <td>
                  12<br/>13<br/>10<br/>10
                </td>
                <td>
                  0.509<br/>0.493<br/>0.538<br/>0.540
                </td>
                <td>
                  0.547<br/>0.605<br/>0.615<br/>0.615
                </td>
                <td>
                  2186<br/>739<br/>3076<br/>2956
                </td>
              </tr>
              <tr class="uk-active">
                <td class="uk-text-bold">Ours (DRL Replanner)</td>
                <td class="uk-text-bold">77</td>
                <td class="uk-text-bold">4</td>
                <td class="uk-text-bold">0.563</td>
                <td class="uk-text-bold">0.668</td>
                <td>2577</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="uk-overflow-auto">
          <table class="uk-table uk-table-small uk-text-small uk-table-divider">
            <thead>
              <tr>
                <th colspan="5" class="uk-text-center">25</th>
              </tr>
              <tr>
                <th>SR ⬆️</th>
                <th>CR ⬇️</th>
                <th>SGT ⬆️</th>
                <th>SPL ⬆️</th>
                <th>NR ⬇️</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>24</td>
                <td class="uk-text-bold">4</td>
                <td>0.418</td>
                <td>0.240</td>
                <td>--</td>
              </tr>
              <tr>
                <td>
                  82<br/>71<br/>79<br/>79
                </td>
                <td>
                  12<br/>6<br/>12<br/>12
                </td>
                <td>
                  0.561<br/>0.482<br/>0.562<br/>0.564
                </td>
                <td>
                  0.705<br/>0.658<br/>0.688<br/>0.688
                </td>
                <td>
                  1995<br/>818<br/>2671<br/>2558
                </td>
              </tr>
              <tr class="uk-active">
                <td class="uk-text-bold">87</td>
                <td>6</td>
                <td class="uk-text-bold">0.600</td>
                <td class="uk-text-bold">0.751</td>
                <td>2066</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

  - text: |
      |Metric||
      |------|------|
      |SR|Success Rate over 100 trials, where success is defined as the robot reaching the goal without collision.|
      |CR|Collision Rate over 100 trials.|
      |SGT|Success-weighted by normalized Goal Time.|
      |SPL|Averate Success-weighted normalized Path Length in the number of trials (100).|
      |NR|Number of Replanning over 100 trials.
  - text: |
      The table lists the quantitave evaluation results of 100 trials for each map layout with Dijkstra (Global) and DWA (Local) planners.
      Our DRL replanner, which learns from its experiences to seek better replanning timings, works comparably well or sometimes substantially bettern than the other rule-based strategies in each environment.

  - text: |
      ### v.s. Stuck-based Replanning
      <div uk-grid>
        <div class="uk-width-1-2 uk-text-center">
          <span class="uk-label uk-label-danger">Ours (DRL Replanner)</span>
          <video
            src="assets/n16-ours.mp4"
            uk-video
            loop
            muted
          />
        </div>
        <div class="uk-width-1-2 uk-text-center">
          <span class="uk-label uk-label-default">Stuck-based</span>
           <video
             src="assets/n16-stuckbased.mp4"
             uk-video
             loop
             muted
           />
        </div>
      </div>
      The stuck-based replanner can aggressively head towards the goal, especially when dynamic obstacles move out of the way. However, replanning after detecting a stuck situation is inefficient. In contrast, our method replans before getting stuck and quickly reaches the goal.

      ### v.s. Time-based Replanning
      <div uk-grid>
        <div class="uk-width-1-2 uk-text-center">
          <span class="uk-label uk-label-danger">Ours (DRL Replanner)</span>
          <video
            src="assets/n9-ours.mp4"
            width="300px"
            class="uk-align-center uk-responsive-width"
            uk-video
            loop
            muted
          />
        </div>
        <div class="uk-width-1-2 uk-text-center">
          <span class="uk-label uk-label-default">Time-based</span>
          <video
            src="assets/n9-timebased.mp4"
            width="300px"
            class="uk-align-center uk-responsive-width"
            uk-video
            loop
            muted
          />
        </div>
      </div>
      While the time-based method is efficient in scenes where obstacles are stationary, as it always tracks the shortest distance, in dynamic scenes, unnecessary replanning can lead to path oscillation, and cases where it fails to reach the goal have been observed. On the other hand, our proposed method efficiently reaches the goal by replanning only at key points.
